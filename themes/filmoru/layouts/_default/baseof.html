<!DOCTYPE html>
<html lang="{{ or site.Language.LanguageCode "en" }}">
<head>
  {{ partial "head.html" . }}
</head>
<body>
  <!-- Holographic Ad Rails -->
  {{ partial "holo-ad-rail.html" . }}

  <div class="container">
    <header>
      {{ partial "header.html" . }}
    </header>
    <main>
      {{ block "main" . }}{{ end }}
    </main>
    <footer>
      {{ partial "footer.html" . }}
    </footer>
  </div>

  <!-- Scroll fade for holo ads -->
  <script>
    (function() {
      const rail = document.querySelector('.holo-rail-right');
      const kofi = document.querySelector('.holo-kofi-float');

      if (!rail && !kofi) return;

      // Align rail top with the banner (right after the header)
      if (rail) {
        const header = document.querySelector('header');
        if (header) {
          const top = header.offsetTop + header.offsetHeight;
          rail.style.top = top + 'px';
          rail.style.maxHeight = 'calc(100vh - ' + (top + 16) + 'px)';
        }
      }

      function updateFade() {
        const scrollY = window.scrollY;
        const halfPage = document.documentElement.scrollHeight / 2;
        const fadeStart = 0;
        const fadeEnd = halfPage;

        let opacity = 1 - (scrollY / fadeEnd);
        opacity = Math.max(0, Math.min(1, opacity));

        if (rail) rail.style.opacity = opacity;
        if (kofi) kofi.style.opacity = opacity;
      }

      window.addEventListener('scroll', updateFade, { passive: true });
      updateFade();
    })();
  </script>
  {{ partial "head/js.html" . }}
</body>
</html>
